(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["c6cf3eb4"],{"3c43":function(t,e){e.endianness=function(){return"LE"},e.hostname=function(){return"undefined"!==typeof location?location.hostname:""},e.loadavg=function(){return[]},e.uptime=function(){return 0},e.freemem=function(){return Number.MAX_VALUE},e.totalmem=function(){return Number.MAX_VALUE},e.cpus=function(){return[]},e.type=function(){return"Browser"},e.release=function(){return"undefined"!==typeof navigator?navigator.appVersion:""},e.networkInterfaces=e.getNetworkInterfaces=function(){return{}},e.arch=function(){return"javascript"},e.platform=function(){return"browser"},e.tmpdir=e.tmpDir=function(){return"/tmp"},e.EOL="\n",e.homedir=function(){return"/"}},"5a56":function(t,e,n){},"5ba9":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"smitad-page"},[n("TitleBar",{attrs:{titleTx:t.title}}),n("div",{staticClass:"smitad-block"},[n("span",{staticStyle:{"font-family":"PingFangSC-Semibold",color:"#44566B"}},[t._v("id: "+t._s(parseInt(t.item.id)))]),n("span",{staticStyle:{"font-family":"PingFangSC-Semibold",color:"#44566B"}},[t._v("申请人："+t._s(t.showshortaddress(t.item.submitter)))]),n("span",{staticStyle:{"font-family":"PingFangSC-Semibold",color:"#44566B"}},[t._v("转账给："+t._s(t.showshortaddress(t.item.destination)))]),n("span",{staticStyle:{"font-family":"PingFangSC-Semibold",color:"#44566B"}},[t._v("转账数量："+t._s(t.showamount(t.item.amount))+" "+t._s("eth"===t.item.type?"ETH":"CMAT"))]),n("span",{staticStyle:{"font-family":"PingFangSC-Semibold",color:"#44566B"}},[t._v("申请时间："+t._s(t.global.convertUTCTimeToLocalTime(1e3*t.item.time)))]),n("span",{staticStyle:{"font-family":"PingFangSC-Semibold",color:"#44566B"}},[t._v("备注："+t._s(t.remark))]),n("span",{staticStyle:{"font-family":"PingFangSC-Semibold",color:"#44566B"}},[t._v("当前已签署人数："+t._s(t.confirms))]),n("span",{staticStyle:{"font-family":"PingFangSC-Semibold",color:"#44566B"}},[t._v("状态："+t._s(!0===t.executed?"已完成":"签署中"))]),""!==t.lastconfirmHash?n("span",{staticStyle:{"font-family":"PingFangSC-Semibold",color:"#3587F2"},on:{click:t.watchlastconfirm}},[n("u",[t._v("查看支出详情")])]):t._e()]),n("q-btn",{staticClass:"btn-next",attrs:{rounded:"",label:"签署",color:"primary"},on:{click:function(e){t.confirm(!0)}}})],1)},o=[];r._withStripped=!0;n("6b54"),n("c5f6"),n("96cf");var i=n("c973"),a=n.n(i),s=n("9bfb"),c=n("e7ea"),l=n("a002"),u=n.n(l),m=n("96a1"),h=(n("3c43"),n("3452")),f={components:{TitleBar:s["a"]},data:function(){return{title:"详情",item:this.$route.query.item,remark:"--",confirms:"--",status:"",agree:"",_isAdmin:"",objectId:"",lastconfirmHash:"",executed:!1}},mounted:function(){console.log(this.$route.query.threshold),this.getbmobremark(),this.getconfirms(),this.isAdmin(),this.getstatus()},methods:{getstatus:function(){var t=this,e=function(){var e=a()(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("cmat"!==t.$route.query.item.type){e.next=6;break}return e.next=3,t.global.cmatmgr.contract.getERC20TransStatus(t.$route.query.item.id);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,t.global.cmatmgr.contract.getETHTransStatus(t.$route.query.item.id);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();e().then(function(e){console.log(e),t.executed=e.executed})},watchlastconfirm:function(){Object(m["a"])(this.global.etherscanio+"tx/"+this.lastconfirmHash)},isAdmin:function(){var t=this,e=function(){var e=a()(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("cmat"!==t.$route.query.item.type){e.next=6;break}return e.next=3,t.global.cmatmgr.contract.isERC20Admin(t.global.wallet.ethAddress);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,t.global.cmatmgr.contract.isETHAdmin(t.global.wallet.ethAddress);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();e().then(function(e){console.log(e),t._isAdmin=e})},confirm:function(t){this._isAdmin?(this.agree=t,this.showPswdInputDialog()):toast("您当前无签署权限")},getconfirms:function(){var t=this,e=function(){var e=a()(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("cmat"!==t.$route.query.item.type){e.next=6;break}return e.next=3,t.global.cmatmgr.contract.erc20CurtConfrims(t.$route.query.item.id);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,t.global.cmatmgr.contract.ethCurtConfrims(t.$route.query.item.id);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();e().then(function(e){t.confirms=parseInt(e)})},showamount:function(t){return Number(c["ethers"].utils.formatEther(t)).toFixed(4)},showshortaddress:function(t){return t.substring(0,10)+"..."+t.substring(t.length-10,t.length)},getbmobremark:function(){var t=this,e={transactionHash:this.$route.query.item.transactionHash};this.$axios.get(this.global.BmobRestAPIUrl+"classes/mgrapplylog?where="+encodeURI(JSON.stringify(e)),{headers:this.global.BmobRestAPIHeaders}).then(function(e){console.log(e),200===e.status&&0!==e.data.results.length&&(t.remark=e.data.results[0].remark,t.objectId=e.data.results[0].objectId,"undefined"!==typeof e.data.results[0].lastconfirmHash&&(t.lastconfirmHash=e.data.results[0].lastconfirmHash))})},showPswdInputDialog:function(){var t=this;this.$q.dialog({title:this.itmeName1,message:this.$t("enterpswd"),prompt:{model:"",type:"text"},ok:this.$t("ok"),cancel:this.$t("cancel"),color:"secondary"}).then(function(e){""===e?toast(t.$t("pswdnull")):(t.$q.loading.show({message:t.$t("txsubmiting"),spinnerSize:50}),u.a.getItem("cryptMnemonic").then(function(n){null===n?(t.$q.loading.hide(),toast(t.$t("toastnowallet")),t.$router.push("/walletfirst")):t.unlockWallet(n,e)}).catch(function(t){toast(t)}))}).catch(function(){})},unlockWallet:function(t,e){var n=this;try{var r=h.AES.decrypt(t,e),o=r.toString(h.enc.Utf8),i=c["ethers"].Wallet.fromMnemonic(o),a=i.connect(this.global.defaultProvider);this.doSubmit(a)}catch(t){console.error(t),toast(n.$t("passworderror")),this.$q.loading.hide()}},doSubmit:function(t){var e=this,n=this.global.cmatmgr.contract.connect(t);"eth"===this.$route.query.item.type?n.confirmTransETH(this.$route.query.item.id,this.agree).then(function(t){console.log(t),e.$q.loading.hide(),e.showInfoDialog(e.$t("submitted"),t.hash),e.listen4InvestResult(t.hash,"签署成功","签署失败"),e.$route.query.threshold-e.confirms===1&&(e.addlastconfirmHash(t.hash),e.lastconfirmHash=t.hash)}).catch(function(t){e.global.reprotError2Bmob(e,"confirmTransETH",t),e.$q.loading.hide()}):n.confirmTransERC20(this.$route.query.item.id,this.agree).then(function(t){console.log(t),e.$q.loading.hide(),e.showInfoDialog(e.$t("submitted"),t.hash),e.listen4InvestResult(t.hash,"签署成功","签署失败"),e.$route.query.threshold-e.confirms===1&&(e.addlastconfirmHash(t.hash),e.lastconfirmHash=t.hash)}).catch(function(t){e.global.reprotError2Bmob(e,"confirmTransERC20",t),e.$q.loading.hide()})},listen4InvestResult:function(t,e,n){this.global.defaultProvider.once(t,function(t){console.log("----Transaction Minded:----"),console.log(t),1===t.status?toast(e):toast(n)})},showInfoDialog:function(t,e){var n=this;this.$q.dialog({title:t,message:"",ok:n.$t("viewresults"),cancel:n.$t("close")}).then(function(){n.$router.go(-1),Object(m["a"])(n.global.etherscanio+"tx/"+e)}).catch(function(){n.$router.go(-1)})},addlastconfirmHash:function(t){this.$axios.put(this.global.BmobRestAPIUrl+"classes/mgrapplylog/"+this.objectId,{lastconfirmHash:t},{headers:this.global.BmobRestAPIHeaders}).then(function(t){console.log(t)})}}},d=f,g=(n("b1d4"),n("2877")),b=Object(g["a"])(d,r,o,!1,null,"716c2bd2",null);b.options.__file="MgrSubDetail.vue";e["default"]=b.exports},"9bfb":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title-bar"},[n("q-icon",{staticClass:"title-back-icon",attrs:{name:"navigate_before"},nativeOn:{click:function(e){return t.goBack(e)}}}),n("div",{staticClass:"title-tx"},[t._v(t._s(t.titleTx))])],1)},o=[];r._withStripped=!0;var i={props:["titleTx"],methods:{goBack:function(){this.$router.go(-1)}}},a=i,s=(n("a675"),n("2877")),c=Object(s["a"])(a,r,o,!1,null,null,null);c.options.__file="TitleBar.vue";e["a"]=c.exports},a675:function(t,e,n){"use strict";var r=n("ca51"),o=n.n(r);o.a},b1d4:function(t,e,n){"use strict";var r=n("5a56"),o=n.n(r);o.a},ca51:function(t,e,n){}}]);