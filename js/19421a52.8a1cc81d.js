(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["19421a52"],{"60d7":function(t,e,n){"use strict";var o=n("d70b"),s=n.n(o);s.a},"9bfb":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title-bar"},[n("q-icon",{staticClass:"title-back-icon",attrs:{name:"navigate_before"},nativeOn:{click:function(e){return t.goBack(e)}}}),n("div",{staticClass:"title-tx"},[t._v(t._s(t.titleTx))])],1)},s=[];o._withStripped=!0;var i={props:["titleTx"],methods:{goBack:function(){this.$router.go(-1)}}},a=i,r=(n("a675"),n("2877")),l=Object(r["a"])(a,o,s,!1,null,null,null);l.options.__file="TitleBar.vue";e["a"]=l.exports},a675:function(t,e,n){"use strict";var o=n("ca51"),s=n.n(o);s.a},b9ff:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"smitad-page"},[n("TitleBar",{attrs:{titleTx:t.title}}),n("div",{staticClass:"smitad-block"},[n("span",[t._v("请选择币种：")]),n("div",{staticClass:"radiogroup"},[n("q-radio",{attrs:{val:"cmat",color:"secondary",label:"CMAT"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}}),n("q-radio",{staticStyle:{"margin-left":"10px"},attrs:{val:"eth",color:"amber",label:"ETH"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1),n("q-input",{attrs:{"float-label":"请填写地址"},model:{value:t.toAddress,callback:function(e){t.toAddress=e},expression:"toAddress"}})],1),n("q-btn",{staticClass:"btn-next",attrs:{rounded:"",label:"查询",color:"primary"},on:{click:t.queryisAdmin}}),n("q-btn",{staticClass:"btn-next",attrs:{rounded:"",label:"设置为多签地址",color:"primary"},on:{click:function(e){t.submit(!0)}}}),t._e()],1)},s=[];o._withStripped=!0;n("6b54"),n("96cf");var i=n("c973"),a=n.n(i),r=n("9bfb"),l=n("e7ea"),c=n("a002"),u=n.n(c),d=n("96a1"),h=n("3452"),m={components:{TitleBar:r["a"]},data:function(){return{title:"多签设置",type:"cmat",toAddress:"",toAmount:"",isAdmin:""}},mounted:function(){},methods:{queryisAdmin:function(){var t=this;if("cmat"===t.type){var e=function(){var e=a()(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.global.cmatmgr.contract.isERC20Admin(t.toAddress);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();e().then(function(t){toast(!1===t?"当前地址无CMAT签署权限":"当前地址有CMAT签署权限")})}else{var n=function(){var e=a()(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.global.cmatmgr.contract.isETHAdmin(t.toAddress);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();n().then(function(t){toast(!1===t?"当前地址无ETH签署权限":"当前地址有ETH签署权限")})}},submit:function(t){this.isAdmin=t,this.showPswdInputDialog()},showPswdInputDialog:function(){var t=this;this.$q.dialog({title:this.itmeName1,message:this.$t("enterpswd"),prompt:{model:"",type:"text"},ok:this.$t("ok"),cancel:this.$t("cancel"),color:"secondary"}).then(function(e){""===e?toast(t.$t("pswdnull")):(t.$q.loading.show({message:t.$t("txsubmiting"),spinnerSize:50}),u.a.getItem("cryptMnemonic").then(function(n){null===n?(t.$q.loading.hide(),toast(t.$t("toastnowallet")),t.$router.push("/walletfirst")):t.unlockWallet(n,e)}).catch(function(t){toast(t)}))}).catch(function(){})},unlockWallet:function(t,e){var n=this;try{var o=h.AES.decrypt(t,e),s=o.toString(h.enc.Utf8),i=l["ethers"].Wallet.fromMnemonic(s),a=i.connect(this.global.defaultProvider);this.doSubmit(a)}catch(t){console.error(t),toast(n.$t("passworderror")),this.$q.loading.hide()}},doSubmit:function(t){var e=this,n=this.global.cmatmgr.contract.connect(t);"eth"===this.type?n.setETHAdmin(this.toAddress,this.isAdmin).then(function(t){console.log(t),e.$q.loading.hide(),e.showInfoDialog(e.$t("submitted"),t.hash),e.listen4InvestResult(t.hash,"操作成功","操作失败")}).catch(function(t){e.global.reprotError2Bmob(e,"setETHAdmin",t),e.$q.loading.hide()}):n.setERC20Admin(this.toAddress,this.isAdmin).then(function(t){console.log(t),e.$q.loading.hide(),e.showInfoDialog(e.$t("submitted"),t.hash),e.listen4InvestResult(t.hash,"操作成功","操作失败")}).catch(function(t){e.global.reprotError2Bmob(e,"setERC20Admin",t),e.$q.loading.hide()})},listen4InvestResult:function(t,e,n){this.global.defaultProvider.once(t,function(t){console.log("----Transaction Minded:----"),console.log(t),1===t.status?toast(e):toast(n)})},showInfoDialog:function(t,e){var n=this;this.$q.dialog({title:t,message:"",ok:n.$t("viewresults"),cancel:n.$t("close")}).then(function(){n.$router.go(-1),Object(d["a"])(n.global.etherscanio+"tx/"+e)}).catch(function(){n.$router.go(-1)})},addbmobLog:function(t){this.$axios.post(this.global.BmobRestAPIUrl+"classes/mgrapplylog",{type:this.type,remark:this.remark,applyer:this.global.wallet.ethAddress,transactionHash:t,toAddress:this.toAddress,toAmount:this.toAmount},{headers:this.global.BmobRestAPIHeaders}).then(function(t){console.log(t)})}}},f=m,p=(n("60d7"),n("2877")),b=Object(p["a"])(f,o,s,!1,null,"42ffee3e",null);b.options.__file="MutiSignSet.vue";e["default"]=b.exports},ca51:function(t,e,n){},d70b:function(t,e,n){}}]);